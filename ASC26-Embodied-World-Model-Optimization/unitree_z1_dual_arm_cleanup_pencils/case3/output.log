2026-01-31 06:52:40.607631: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-31 06:52:40.643955: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-01-31 06:52:40.643989: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-01-31 06:52:40.645795: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-01-31 06:52:40.654129: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-01-31 06:52:42.029695: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[rank: 0] Global seed set to 123
/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/kornia/feature/lightglue.py:44: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  @torch.cuda.amp.custom_fwd(cast_inputs=torch.float32)
INFO:mainlogger:LatentVisualDiffusion: Running in v-prediction mode
forward
INFO:unifolm_wma.models.diffusion_head.conditional_unet1d:number of parameters: 5.010531e+08
INFO:unifolm_wma.models.diffusion_head.conditional_unet1d:number of parameters: 5.010531e+08
AE working on z of shape (1, 4, 32, 32) = 4096 dimensions.
INFO:root:Loaded ViT-H-14 model config.
INFO:root:Loaded ViT-H-14 model config.
>>> model checkpoint loaded.
>>> Load pre-trained model ...
INFO:root:***** Configing Data *****
>>> Setting target_dataset to: unitree_z1_dual_arm_cleanup_pencils
>>> Setting prompt_dir to: unitree_z1_dual_arm_cleanup_pencils/case3/world_model_interaction_prompts
>>> Loading only target dataset: unitree_z1_dual_arm_cleanup_pencils
>>> Using prompt_dir: unitree_z1_dual_arm_cleanup_pencils/case3/world_model_interaction_prompts
>>> Absolute path: /mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/unitree_z1_dual_arm_cleanup_pencils/case3/world_model_interaction_prompts
>>> Dataset: unitree_z1_dual_arm_cleanup_pencils
    meta_path: /mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/unitree_z1_dual_arm_cleanup_pencils/case3/world_model_interaction_prompts/unitree_z1_dual_arm_cleanup_pencils.csv
    transition_dir: /mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/unitree_z1_dual_arm_cleanup_pencils/case3/world_model_interaction_prompts/transitions
    data_dir: /mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/unitree_z1_dual_arm_cleanup_pencils/case3/world_model_interaction_prompts
>>> unitree_z1_dual_arm_cleanup_pencils: 1 data samples loaded.
>>> unitree_z1_dual_arm_cleanup_pencils: data stats loaded.
>>> unitree_z1_dual_arm_cleanup_pencils: normalizer initiated.
>>> Dataset is successfully loaded ...
>>> Generate 16 frames under each generation ...
DEBUG:h5py._conv:Creating converter from 3 to 5
DEBUG:PIL.PngImagePlugin:STREAM b'IHDR' 16 13
DEBUG:PIL.PngImagePlugin:STREAM b'pHYs' 41 9
DEBUG:PIL.PngImagePlugin:STREAM b'IDAT' 62 4096
  0%|          | 0/8 [00:00<?, ?it/s]/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/functional.py:6487: UserWarning: Flash Efficient attention on Current AMD GPU is still experimental. Enable it with TORCH_ROCM_AOTRITON_ENABLE_EXPERIMENTAL=1. (Triggered internally at /pytorch/aten/src/ATen/native/transformers/hip/sdp_utils.cpp:309.)
  attn_output = scaled_dot_product_attention(
/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/functional.py:6487: UserWarning: Mem Efficient attention on Current AMD GPU is still experimental. Enable it with TORCH_ROCM_AOTRITON_ENABLE_EXPERIMENTAL=1. (Triggered internally at /pytorch/aten/src/ATen/native/transformers/hip/sdp_utils.cpp:360.)
  attn_output = scaled_dot_product_attention(
  0%|          | 0/8 [00:01<?, ?it/s]
>>> Step 0: generating actions ...
Traceback (most recent call last):
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/scripts/evaluation/world_model_interaction.py", line 827, in <module>
    run_inference(args, gpu_num, rank)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/scripts/evaluation/world_model_interaction.py", line 592, in run_inference
    pred_videos_0, pred_actions, _ = image_guided_synthesis_sim_mode(
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/scripts/evaluation/world_model_interaction.py", line 410, in image_guided_synthesis_sim_mode
    samples, actions, states, intermedia = ddim_sampler.sample(
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/models/samplers/ddim.py", line 143, in sample
    samples, actions, states, intermediates = self.ddim_sampling(
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/models/samplers/ddim.py", line 257, in ddim_sampling
    outs = self.p_sample_ddim(
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/models/samplers/ddim.py", line 334, in p_sample_ddim
    model_output, model_output_action, model_output_state = self.model.apply_model(
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/models/ddpms.py", line 1267, in apply_model
    x_recon, x_action_recon, x_state_recon = self.model(
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/models/ddpms.py", line 2473, in forward
    out = self.diffusion_model(xc,
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/modules/networks/wma_model.py", line 799, in forward
    h = module(h, emb, context=context, batch_size=b)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/modules/networks/wma_model.py", line 44, in forward
    x = layer(x, context)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/modules/attention.py", line 386, in forward
    x = block(x, context=context, **kwargs)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/modules/attention.py", line 294, in forward
    return checkpoint(self._forward, input_tuple, self.parameters(),
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/utils/common.py", line 111, in checkpoint
    return func(*inputs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/modules/attention.py", line 301, in _forward
    x = self.attn2(self.norm2(x), context=context, mask=mask) + x
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual/ASC26-Embodied-World-Model-Optimization/src/unifolm_wma/modules/attention.py", line 118, in forward
    assert 1 > 2, ">>> ERROR: should setup xformers and use efficient_forward ..."
AssertionError: >>> ERROR: should setup xformers and use efficient_forward ...

real	1m8.998s
user	1m51.731s
sys	0m44.790s
